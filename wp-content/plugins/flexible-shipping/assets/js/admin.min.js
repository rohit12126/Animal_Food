function fs_select2(){let e=jQuery(".fs_select2");e.length&&(jQuery.fn.selectWoo?e.selectWoo():e.select2())}function fs_removeParam(e,i){var s=i.split("?")[0],n=[],t=-1!==i.indexOf("?")?i.split("?")[1]:"";if(""!==t){for(var _=(n=t.split("&")).length-1;_>=0;_-=1)n[_].split("=")[0]===e&&n.splice(_,1);s=s+"?"+n.join("&")}return s}function fs_trimChar(e,i){for(;e.charAt(0)==i;)e=e.substring(1);for(;e.charAt(e.length-1)==i;)e=e.substring(0,e.length-1);return e}function fs_id(e){return jQuery(e).closest(".flexible_shipping_shipment").attr("data-id")}function fs_data_set_val(e,i,s){if(void 0===i)return e;if(-1==i.indexOf("["))e[i]=s;else{var n=i.split("["),t=e,_=e,l="";jQuery.each(n,function(e,i){l=i.replace("]",""),void 0===t[l]&&(t[l]={}),_=t,t=t[l]}),_[l]=s}return e}function fs_ajax(e,i,s){jQuery(".button-shipping").attr("disabled",!0),jQuery(e).parent().find(".spinner").css({visibility:"visible"});var n={};jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_content input, #flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_content select, #flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_content textarea").each(function(){n="radio"==jQuery(this).attr("type")?fs_data_set_val(n,jQuery(this).attr("name"),jQuery("#flexible_shipping_shipment_"+i+" input[name="+jQuery(this).attr("name")+"]:checked").val()):"checkbox"==jQuery(this).attr("type")?jQuery(this).is(":checked")?fs_data_set_val(n,jQuery(this).attr("name"),jQuery(this).val()):fs_data_set_val(n,jQuery(this).attr("name"),""):fs_data_set_val(n,jQuery(this).attr("name"),jQuery(this).val())});var t=jQuery("#flexible_shipping_shipment_nonce_"+i).val();jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").hide(),jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").removeClass("flexible_shipping_shipment_message_error"),jQuery.ajax({url:fs_admin.ajax_url,type:"POST",data:{fs_action:s,action:"flexible_shipping",nonce:t,shipment_id:i,data:n},dataType:"json"}).done(function(e){e?"0"==e?(jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").show(),jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").html("Invalid response: 0")):"success"==e.status?(jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_content").html(e.content),jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").hide(),void 0!==e.message&&(jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").show(),jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").html(e.message))):(void 0!==e.content&&jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_content").html(e.content),jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").addClass("flexible_shipping_shipment_message_error"),jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").show(),jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").html(e.message)):(jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").addClass("flexible_shipping_shipment_message_error"),jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").show(),jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").html("Request failed: invalid method?"))}).always(function(){jQuery(".button-shipping").attr("disabled",!1),jQuery(".shipping-spinner").parent().find(".spinner").css({visibility:"hidden"}),fs_select2()}).fail(function(e,s){jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").addClass("flexible_shipping_shipment_message_error"),jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").show(),jQuery("#flexible_shipping_shipment_"+i+" .flexible_shipping_shipment_message").html("Request failed: "+s+" "+e.status)})}jQuery(document).ready(function(){if(jQuery("#flexible_shipping_labels_url").length&&(window.location.href=jQuery("#flexible_shipping_labels_url").attr("href")),1==jQuery("a.shipping_manifest_download").length&&(window.location.href=jQuery("a.shipping_manifest_download").attr("href")),"function"==typeof window.history.pushState){var e=document.location.href,i=document.location.href;e=fs_removeParam("bulk_flexible_shipping_labels",e),e=fs_removeParam("bulk_flexible_shipping_send",e),e=fs_removeParam("bulk_flexible_shipping_manifests",e),(e=fs_trimChar(e=fs_removeParam("bulk_flexible_shipping_no_labels_created",e),"?"))!=i&&window.history.pushState({},"",e)}var s=jQuery(".fs-connect__vertical-nav-container"),n=jQuery(".fs-connect__content-container");function t(e){s.find(".vertical-menu__feature-item-is-selected").removeClass("vertical-menu__feature-item-is-selected"),n.find(".fs__slide-is-active").removeClass("fs__slide-is-active"),s.children().eq(e).addClass("vertical-menu__feature-item-is-selected"),n.children().eq(e).addClass("fs__slide-is-active")}nextFeatureButtons=jQuery(".fs-banner__button-container .next-feature"),s.on("click",".vertical-menu__feature-item:not( .vertical-menu__feature-item-is-selected )",function(){t(jQuery(this).index())}),nextFeatureButtons.on("click",function(e){e.preventDefault(),t(jQuery(this).closest(".fs-connect__slide").index()+1)})}),jQuery(function(e){e(document).on("click",".flexible-shipping-taxes-notice .notice-dismiss",function(){e.ajax(ajaxurl,{type:"POST",data:{action:"flexible_shipping_taxes_notice"}})}),e(document).on("click","#enable-fs-connect-box",function(){var i;e(".enable-fs-connect-box").prop("checked")?(e(".fs-connect-integration-box").slideDown(),i=1):(e(".fs-connect-integration-box").slideUp(),i=0),e.ajax(ajaxurl,{type:"POST",data:{action:"update_fs_connect_integration_setting",fs_box_state:i}})}),e(document).on("click","#flexible_shipping_rate_plugin .close-fs-rate-notice",function(){e("#flexible_shipping_rate_plugin .notice-dismiss").click()}),e(document).on("click","#flexible_shipping_rate_plugin .fs-not-good",function(){e("#flexible_shipping_rate_plugin p").html(fs_admin.notice_not_good_enought)})});
